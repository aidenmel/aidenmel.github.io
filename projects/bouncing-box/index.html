<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Bouncing Box</title>
	
	<link rel="stylesheet" href="./styles.css">
	<link rel="icon" href="/assets/logo-gen1.png">
	
	<meta name="theme-color" content="#929292">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
	
	<script src="jquery.min.js"></script>
	<!-- 	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> -->

</head>
<body class="board">
	<!-- HTML for the box -->
	<div class="box-container">
		<div class="box">?</div>
	</div>

	<div class="walls">
		<div id="wall_left"></div>
		<div id="wall_right"></div>
	</div>

	<div class="scoreboard" id="score-container">
		<h1>Score: <span id="score">0</span></div>
	</div>

	<div class="statistics">
		<h2>Nerdy Stats</h2>
		<p>SPEED: <span id='stats-speed'>0 pixels/sec</span></p>
		<p>POSITION: <span id='stats-pos'>0 pixels</span></p>
	</div>

	<script>
		(function(){
			'use strict'
			/* global jQuery */

			//////////////////////////////////////////////////////////////////
			/////////////////// SETUP DO NOT DELETE //////////////////////////
			//////////////////////////////////////////////////////////////////
			
			var box = jQuery('.box');	// reference to the HTML .box element
			var board = jQuery('.board');	// reference to the HTML .board element
			var boardWidth = innerWidth;	// the maximum X-Coordinate of the screen

			// Every 50 milliseconds, call the update Function (see below)
			setInterval(update, 30); // 60 fps
			
			// Every time the box is clicked, call the handleBoxClick Function (see below)
			box.on('click', handleBoxClick);

			// moves the Box to a new position on the screen along the X-Axis
			function moveBoxTo(newPositionX) {
				box.css("left", newPositionX);
			}

			// changes the text displayed on the Box
			function changeBoxText(newText) {
				box.text(newText);
			}

			//////////////////////////////////////////////////////////////////
			/////////////////// YOUR CODE BELOW HERE /////////////////////////
			//////////////////////////////////////////////////////////////////
			
			/*

			[IDEA BOARD]
			- Game mode support (Standard, Chaos, Infinite)
			- Random events (Stored in a array, maybe?)
			- Instructions/start screen
			- Collision effects
			- Score effects
			- Milestone effects (w/ confetti?) (25, 50, 100??)

			*/


			// TODO 2 - Variable declarations 

			// Objects
				var ScoreContainer = document.getElementById('score-container')
				var ScoreCounter = document.getElementById('score')

				// Walls
				var wall_left = document.getElementById('wall_left');
				var wall_right = document.getElementById('wall_right');

				// Statistics
				var stats_speed = document.getElementById('stats-speed')
				var stats_pos = document.getElementById('stats-pos')

			// Values
			var positionX = 10;
			var speed = 10;
			var score = 0;

			var randomColor = 'rgb(34, 199, 199)'
			
			// Functions
			function updateCssProperty(object, property, value){
				console.log(object)
				object.style[property] = value;
			}

			function playAnimation(object, css_class, time){
				// Play css animation
				object.classList.add(css_class); // Adds class to object
				setTimeout(() => { object.classList.remove(css_class);}, time); // Delay before removing class
			}

			/* 
			This Function will be called 20 times/second. Each time it is called,
			it should move the Box to a new location. If the box drifts off the screen
			turn it around! 
			*/
			function update() {

				positionX = positionX + speed

				// Update frame
				moveBoxTo(positionX)

				// Collisions
				if (positionX > (boardWidth - 70)){
					speed *= -1;
					updateCssProperty(wall_right, 'box-shadow', '-16px 0 32px 0 ' + randomColor)
					playAnimation(wall_right, 'Touched', 200)
				} else if ((positionX) < 0){
					speed *= -1;
					updateCssProperty(wall_left, 'box-shadow', '16px 0 32px 0 ' + randomColor)
					playAnimation(wall_left, 'Touched', 200)
				}

				// Statistics
				stats_speed.innerHTML = speed + ' pixels/sec';
				stats_pos.innerHTML = positionX + ' pixels';
			};

			/* 
			This Function will be called each time the box is clicked. Each time it is called,
			it should increase the points total, increase the speed, and move the box to
			the left side of the screen.
			*/
			function handleBoxClick() {

				// Update speed depending on whether the value is positive or negative
				if (Math.sign(speed) === -1){
					speed -= 3
				} else {
					speed += 3
				}

				// Select a random color
				var hue = Math.random() * 360;
				var saturation = 90;
				var lightness = 45;

				randomColor = `hsl(${hue}, ${saturation}%, ${lightness}%)`;

				// Update color
				box.css('background-color', randomColor);

				// Update score
				score += 1;
				changeBoxText(score);
				playAnimation(ScoreContainer, 'active', 200)
				ScoreCounter.innerHTML = score
				ScoreCounter.style.color = randomColor
				

				// Return box to starting position
				positionX = 1; 

			};
		})();
	</script>
</body>
</html>
